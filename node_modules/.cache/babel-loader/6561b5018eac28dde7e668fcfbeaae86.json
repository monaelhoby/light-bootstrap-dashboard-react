{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { functions, db } from \"../firebase\";\nimport { useAuth } from \"../components/contexts/AuthContext\";\nconst deleteUser = functions.httpsCallable(\"deleteUser\");\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\nconst updateUser = functions.httpsCallable(\"updateUser\");\nexport const handleUpdateUser = (user, setUsers, callback) => {\n  let theUsers = [];\n  return updateUser(user).then(() => {\n    db.collection(\"users\").doc(user.uid).update({\n      email: user.email,\n      password: user.password,\n      userName: user.userName,\n      userCode: user.userCode,\n      products: user.products\n    }).then(() => {\n      db.collection(\"users\").get().then(snapshot => {\n        snapshot.docs.forEach(user => {\n          user.checked = false;\n          user.purchased = false;\n          theUsers.push(user);\n        });\n        setUsers([...theUsers]);\n      });\n    });\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUser = (uid, users, i, setUsers) => {\n  users.splice(i, 1);\n  setUsers([...users]);\n  return deleteUser({\n    uid: uid\n  }).then(() => {\n    db.collection(\"users\").doc(uid).delete();\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUsers = ids => {\n  return deleteUsers(ids).then(res => {\n    console.log(\"res after deleting users\", res);\n    ids.forEach(uid => {\n      db.collection(\"users\").doc(uid).delete();\n    });\n  }).catch(err => {\n    console.log(\"ERR\", err);\n  });\n};\nexport const handleSubmit = async (e, firstNameRef, lastNameRef, codeRef) => {\n  _s();\n\n  console.log(\"work\");\n  const {\n    signup\n  } = useAuth();\n  e.preventDefault();\n\n  if (passwordRef.current.value !== passwordConfirmRef.current.value) {\n    return setError(\"Passwords do not match\");\n  }\n\n  setError(\"\");\n  setLoading(true);\n  await signup(emailRef.current.value, passwordRef.current.value).then(function (cred) {\n    db.collection(\"products\").get().then(snapshot => {\n      let theUser = {};\n      theUser.email = cred.user.email; // theUser.password= '';\n\n      theUser.firstName = firstNameRef;\n      theUser.lastName = lastNameRef;\n      theUser.userCode = codeRef;\n      theUser.creationDate = cred.user.metadata.creationTime;\n      theUser.lastLoginDate = cred.user.metadata.lastSignInTime;\n      theUser.products = [];\n      snapshot.docs.forEach(p => {\n        let oneProduct = {};\n        oneProduct.name = p.data().name;\n        oneProduct.visibility = p.data().visibility;\n        oneProduct.apps = [];\n        oneProduct.comments = \"comment\";\n        oneProduct.purchased = false;\n        oneProduct.purchasedUrl = p.data().purchasedUrl;\n        oneProduct.unpurchasedUrl = p.data().unpurchasedUrl;\n        oneProduct.datePurchased = \"22/1/2021\";\n        p.data().apps.forEach(app => {\n          oneProduct.apps.push({\n            name: app,\n            active: false,\n            purchased: false,\n            credentials: false,\n            expireDate: \"30/3/2021\",\n            timesAppLaunchedLastLogin: 3,\n            timesAppLaunchedPurchased: 4,\n            lastLaunchDate: \"23-12-2020\",\n            timesAppLaunched: 7,\n            deviceId: \"1.23.456.5\"\n          });\n        });\n        theUser.products.push(oneProduct);\n        console.log(\"the user is \", theUser.products);\n      });\n      return db.collection('users').doc(cred.user.uid).set(theUser);\n    });\n  }).catch(err => {\n    setError(\"Failed to create an account\");\n  });\n  setLoading(false);\n};\n\n_s(handleSubmit, \"F7pe3lQzDbOMKrOCSgX/j44VZ2M=\", false, function () {\n  return [useAuth];\n});\n\nconst deleteDoc = n => {\n  if (n == 0) return;\n  console.log(n);\n};\n\nconst returnFilteredUsers = (users, userId) => {\n  let newUsers = users.filter(user => {\n    return user.id !== userId;\n  });\n  return newUsers;\n};","map":{"version":3,"sources":["E:/Folder/React/projects/my_freelance_work/M.Ramdan Work/light-bootstrap-dashboard-react/src/views/UsersAction.js"],"names":["functions","db","useAuth","deleteUser","httpsCallable","deleteUsers","updateUser","handleUpdateUser","user","setUsers","callback","theUsers","then","collection","doc","uid","update","email","password","userName","userCode","products","get","snapshot","docs","forEach","checked","purchased","push","catch","err","console","log","handleDeleteUser","users","i","splice","delete","handleDeleteUsers","ids","res","handleSubmit","e","firstNameRef","lastNameRef","codeRef","signup","preventDefault","passwordRef","current","value","passwordConfirmRef","setError","setLoading","emailRef","cred","theUser","firstName","lastName","creationDate","metadata","creationTime","lastLoginDate","lastSignInTime","p","oneProduct","name","data","visibility","apps","comments","purchasedUrl","unpurchasedUrl","datePurchased","app","active","credentials","expireDate","timesAppLaunchedLastLogin","timesAppLaunchedPurchased","lastLaunchDate","timesAppLaunched","deviceId","set","deleteDoc","n","returnFilteredUsers","userId","newUsers","filter","id"],"mappings":"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","sourcesContent":["import { functions, db } from \"../firebase\";\r\nimport { useAuth } from \"../components/contexts/AuthContext\"\r\nconst deleteUser  = functions.httpsCallable(\"deleteUser\");\r\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\r\nconst updateUser  = functions.httpsCallable(\"updateUser\");\r\n\r\nexport const handleUpdateUser = (user,setUsers,callback)=>{\r\n    let theUsers = []\r\n    return updateUser(user)\r\n    .then(()=>{\r\n        db.collection(\"users\").doc(user.uid).update({\r\n            email:user.email,\r\n            password:user.password,\r\n            userName:user.userName,\r\n            userCode:user.userCode,\r\n            products:user.products\r\n        }).then(()=>{\r\n            db.collection(\"users\").get().then(snapshot=>{\r\n                snapshot.docs.forEach(user=>{\r\n                    user.checked = false;\r\n                    user.purchased = false;\r\n                    theUsers.push(user);\r\n                })\r\n                setUsers([...theUsers]);\r\n            })\r\n        })\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUser = (uid,users,i,setUsers)=>{\r\n    users.splice(i, 1);\r\n    setUsers([...users]);\r\n\r\n    return deleteUser({uid:uid})\r\n    .then(()=>{\r\n        db.collection(\"users\").doc(uid).delete();\r\n\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\nexport const handleDeleteUsers = (ids) =>{\r\n    return deleteUsers(ids)\r\n    .then(res=>{\r\n        console.log(\"res after deleting users\",res);\r\n        ids.forEach(uid => {\r\n            db.collection(\"users\").doc(uid).delete();\r\n        });\r\n    }).catch(err=>{\r\n        console.log(\"ERR\",err);\r\n    })\r\n}\r\n\r\nexport const handleSubmit = async(e,firstNameRef,lastNameRef,codeRef) => {\r\n     console.log(\"work\")\r\n    const { signup } = useAuth();\r\n    e.preventDefault();\r\n\r\n    if (passwordRef.current.value !== passwordConfirmRef.current.value) {\r\n      return setError(\"Passwords do not match\");\r\n    }\r\n\r\n    setError(\"\");\r\n    setLoading(true);\r\n    await signup(emailRef.current.value, passwordRef.current.value)\r\n    .then(function(cred){\r\n      db.collection(\"products\").get().then(snapshot=>{\r\n      let theUser = {};\r\n      theUser.email= cred.user.email;\r\n      // theUser.password= '';\r\n      theUser.firstName= firstNameRef;\r\n      theUser.lastName= lastNameRef;\r\n      theUser.userCode= codeRef;\r\n      theUser.creationDate=cred.user.metadata.creationTime;\r\n      theUser.lastLoginDate=cred.user.metadata.lastSignInTime;\r\n      theUser.products = [];\r\n        \r\n      snapshot.docs.forEach(p=>{\r\n        let oneProduct = {};\r\n        oneProduct.name = p.data().name;\r\n        oneProduct.visibility = p.data().visibility;\r\n        oneProduct.apps = [];\r\n        oneProduct.comments = \"comment\";\r\n        oneProduct.purchased = false;\r\n        oneProduct.purchasedUrl = p.data().purchasedUrl;\r\n        oneProduct.unpurchasedUrl = p.data().unpurchasedUrl;\r\n        oneProduct.datePurchased = \"22/1/2021\";\r\n        p.data().apps.forEach(app=>{\r\n          oneProduct.apps.push({\r\n            name:app,\r\n            active:false,\r\n            purchased: false,\r\n            credentials : false,\r\n            expireDate: \"30/3/2021\",\r\n            timesAppLaunchedLastLogin : 3,\r\n            timesAppLaunchedPurchased : 4,\r\n            lastLaunchDate : \"23-12-2020\",\r\n            timesAppLaunched : 7,\r\n            deviceId : \"1.23.456.5\"\r\n          })\r\n        })\r\n        theUser.products.push(oneProduct);\r\n        console.log(\"the user is \", theUser.products)\r\n      })\r\n\r\n      return db.collection('users').doc(cred.user.uid).set(theUser) \r\n      })\r\n    }) \r\n    .catch(err=>{\r\n      setError(\"Failed to create an account\");\r\n    })\r\n\r\n    setLoading(false);\r\n  }\r\n\r\n\r\nconst deleteDoc = (n)=>{\r\n    if(n == 0) return;\r\n\r\n    console.log(n);\r\n}\r\n\r\nconst returnFilteredUsers = (users,userId)=>{\r\n    let newUsers = users.filter(user=>{\r\n        return user.id !== userId;\r\n    })\r\n    return newUsers; \r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}