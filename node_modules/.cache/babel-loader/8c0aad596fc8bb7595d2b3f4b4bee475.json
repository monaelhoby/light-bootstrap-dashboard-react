{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { functions, db } from \"../firebase\";\nimport { useAuth } from \"../components/contexts/AuthContext\";\nconst deleteUser = functions.httpsCallable(\"deleteUser\");\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\nconst updateUser = functions.httpsCallable(\"updateUser\");\nexport const handleUpdateUser = (user, setUsers, callback) => {\n  let theUsers = [];\n  console.log(\"user is \", user);\n  return updateUser(user).then(theRecordedUser => {\n    console.log(\"theRecordedUser\", theRecordedUser);\n    db.collection(\"users\").doc(user.uid).update({\n      email: user.email,\n      password: user.password,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      userCode: user.userCode,\n      products: user.products\n    }).then(() => {\n      db.collection(\"users\").get().then(snapshot => {\n        snapshot.docs.forEach(user => {\n          user.checked = false;\n          user.purchased = false;\n          theUsers.push(user);\n        });\n        setUsers([...theUsers]);\n      });\n    });\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUser = (uid, users, i, setUsers, callback) => {\n  // console.log(\"useActionI\", i)\n  users.splice(i, 1);\n  setUsers([...users]);\n  return deleteUser({\n    uid: uid\n  }).then(() => {\n    db.collection(\"users\").doc(uid).delete();\n    callback();\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUsers = (ids, callback) => {\n  return deleteUsers(ids).then(res => {\n    console.log(\"res after deleting users\", res);\n    ids.forEach(uid => {\n      db.collection(\"users\").doc(uid).delete();\n    });\n    callback();\n  }).catch(err => {\n    console.log(\"ERR\", err);\n  });\n};\nexport const handleSubmit = async (e, firstNameRef, lastNameRef, codeRef) => {\n  _s();\n\n  const {\n    signup\n  } = useAuth();\n  e.preventDefault();\n  setError(\"\");\n  setLoading(true);\n  await signup(emailRef.current.value, passwordRef.current.value).then(function (cred) {\n    db.collection(\"products\").get().then(snapshot => {\n      let theUser = {};\n      theUser.email = cred.user.email; // theUser.password= '';\n\n      theUser.firstName = firstNameRef;\n      theUser.lastName = lastNameRef;\n      theUser.userCode = codeRef;\n      theUser.creationDate = cred.user.metadata.creationTime;\n      theUser.lastLoginDate = cred.user.metadata.lastSignInTime;\n      theUser.products = [];\n      snapshot.docs.forEach(p => {\n        let oneProduct = {};\n        oneProduct.name = p.data().name;\n        oneProduct.visibility = p.data().visibility;\n        oneProduct.apps = [];\n        oneProduct.comments = \"comment\";\n        oneProduct.purchased = false;\n        oneProduct.purchasedUrl = p.data().purchasedUrl;\n        oneProduct.unpurchasedUrl = p.data().unpurchasedUrl;\n        oneProduct.productIcon = p.data().productIcon;\n        oneProduct.datePurchased = \"22/1/2021\";\n        p.data().apps.forEach(app => {\n          oneProduct.apps.push({\n            name: app.name,\n            activeUrl: app.activeUrl,\n            inActiveUrl: app.inActiveUrl,\n            active: false,\n            appIcon: app.appIcon,\n            purchased: false,\n            credentials: false,\n            expireDate: \"30/3/2021\",\n            timesAppLaunchedLastLogin: 3,\n            timesAppLaunchedPurchased: 4,\n            lastLaunchDate: \"23-12-2020\",\n            launchesSinceActive: \"8-6-2020\",\n            dateOfLastUse: \"8-6-2020\",\n            activatedOn: \"8-6-2020\",\n            timesAppLaunched: 7,\n            codeUsed: \"9877\",\n            deviceId: \"1.23.456.5\"\n          });\n        });\n        p.data().features.forEach(feature => {\n          oneProduct.features.push({\n            name: feature.name,\n            activeUrl: feature.activeUrl,\n            inActiveUrl: feature.inActiveUrl,\n            tag: feature.tag\n          });\n        });\n        theUser.products.push(oneProduct);\n        console.log(\"the user is \", theUser.products);\n      });\n      return db.collection('users').doc(cred.user.uid).set(theUser);\n    });\n  }).catch(err => {\n    setError(\"Failed to create an account\");\n  });\n  setLoading(false);\n};\n\n_s(handleSubmit, \"F7pe3lQzDbOMKrOCSgX/j44VZ2M=\", false, function () {\n  return [useAuth];\n});\n\nconst deleteDoc = n => {\n  if (n == 0) return;\n  console.log(n);\n};\n\nconst returnFilteredUsers = (users, userId) => {\n  let newUsers = users.filter(user => {\n    return user.id !== userId;\n  });\n  return newUsers;\n};","map":{"version":3,"sources":["E:/Folder/React/projects/my_freelance_work/M.Radwan Work/light-bootstrap-dashboard-react/src/views/UsersAction.js"],"names":["functions","db","useAuth","deleteUser","httpsCallable","deleteUsers","updateUser","handleUpdateUser","user","setUsers","callback","theUsers","console","log","then","theRecordedUser","collection","doc","uid","update","email","password","firstName","lastName","userCode","products","get","snapshot","docs","forEach","checked","purchased","push","catch","err","handleDeleteUser","users","i","splice","delete","handleDeleteUsers","ids","res","handleSubmit","e","firstNameRef","lastNameRef","codeRef","signup","preventDefault","setError","setLoading","emailRef","current","value","passwordRef","cred","theUser","creationDate","metadata","creationTime","lastLoginDate","lastSignInTime","p","oneProduct","name","data","visibility","apps","comments","purchasedUrl","unpurchasedUrl","productIcon","datePurchased","app","activeUrl","inActiveUrl","active","appIcon","credentials","expireDate","timesAppLaunchedLastLogin","timesAppLaunchedPurchased","lastLaunchDate","launchesSinceActive","dateOfLastUse","activatedOn","timesAppLaunched","codeUsed","deviceId","features","feature","tag","set","deleteDoc","n","returnFilteredUsers","userId","newUsers","filter","id"],"mappings":"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","sourcesContent":["import { functions, db } from \"../firebase\";\r\nimport { useAuth } from \"../components/contexts/AuthContext\"\r\nconst deleteUser  = functions.httpsCallable(\"deleteUser\");\r\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\r\nconst updateUser  = functions.httpsCallable(\"updateUser\");\r\n\r\nexport const handleUpdateUser = (user,setUsers,callback)=>{\r\n    let theUsers = [];\r\n    console.log(\"user is \", user)\r\n    return updateUser(user)\r\n    .then((theRecordedUser)=>{\r\n        console.log(\"theRecordedUser\",theRecordedUser)\r\n        db.collection(\"users\").doc(user.uid).update({\r\n            email:user.email,\r\n            password:user.password,\r\n            firstName:user.firstName,\r\n            lastName:user.lastName,\r\n            userCode:user.userCode,\r\n            products:user.products\r\n        }).then(()=>{\r\n            db.collection(\"users\").get().then(snapshot=>{\r\n                snapshot.docs.forEach(user=>{\r\n                    user.checked = false;\r\n                    user.purchased = false;\r\n                    theUsers.push(user);\r\n                })\r\n                setUsers([...theUsers]);\r\n            })\r\n        })\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUser = (uid,users,i,setUsers,callback)=>{\r\n    // console.log(\"useActionI\", i)\r\n    users.splice(i, 1);\r\n    setUsers([...users]);\r\n\r\n    return deleteUser({uid:uid})\r\n    .then(()=>{\r\n        db.collection(\"users\").doc(uid).delete();\r\n        callback()\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\nexport const handleDeleteUsers = (ids, callback) =>{\r\n    return deleteUsers(ids)\r\n    .then(res=>{\r\n        console.log(\"res after deleting users\",res);\r\n        ids.forEach(uid => {\r\n            db.collection(\"users\").doc(uid).delete();\r\n        });\r\n        callback()\r\n    }).catch(err=>{\r\n        console.log(\"ERR\",err);\r\n    })\r\n}\r\n\r\nexport const handleSubmit = async(e,firstNameRef, lastNameRef,codeRef) => {\r\n    const { signup } = useAuth();\r\n    e.preventDefault();\r\n\r\n    setError(\"\");\r\n    setLoading(true);\r\n    await signup(emailRef.current.value, passwordRef.current.value)\r\n    .then(function(cred){\r\n      db.collection(\"products\").get().then(snapshot=>{\r\n      let theUser = {};\r\n      theUser.email= cred.user.email;\r\n      // theUser.password= '';\r\n      theUser.firstName= firstNameRef;\r\n      theUser.lastName= lastNameRef;\r\n      theUser.userCode= codeRef;\r\n      theUser.creationDate=cred.user.metadata.creationTime;\r\n      theUser.lastLoginDate=cred.user.metadata.lastSignInTime;\r\n      theUser.products = [];\r\n        \r\n      snapshot.docs.forEach(p=>{\r\n        let oneProduct = {};\r\n        oneProduct.name = p.data().name;\r\n        oneProduct.visibility = p.data().visibility;\r\n        oneProduct.apps = [];\r\n        oneProduct.comments = \"comment\";\r\n        oneProduct.purchased = false;\r\n        oneProduct.purchasedUrl = p.data().purchasedUrl;\r\n        oneProduct.unpurchasedUrl = p.data().unpurchasedUrl;\r\n        oneProduct.productIcon = p.data().productIcon;\r\n        oneProduct.datePurchased = \"22/1/2021\";\r\n        p.data().apps.forEach(app=>{\r\n          oneProduct.apps.push({\r\n            name:app.name,\r\n            activeUrl:app.activeUrl,\r\n            inActiveUrl:app.inActiveUrl,\r\n            active:false,\r\n            appIcon : app.appIcon,\r\n            purchased: false,\r\n            credentials : false,\r\n            expireDate: \"30/3/2021\",\r\n            timesAppLaunchedLastLogin : 3,\r\n            timesAppLaunchedPurchased : 4,\r\n            lastLaunchDate : \"23-12-2020\",\r\n            launchesSinceActive :\"8-6-2020\",\r\n            dateOfLastUse: \"8-6-2020\",\r\n            activatedOn: \"8-6-2020\",\r\n            timesAppLaunched : 7,\r\n            codeUsed: \"9877\",\r\n            deviceId : \"1.23.456.5\"\r\n          })\r\n        })\r\n        p.data().features.forEach(feature => {\r\n            oneProduct.features.push({\r\n                name:feature.name,\r\n                activeUrl:feature.activeUrl,\r\n                inActiveUrl:feature.inActiveUrl,\r\n                tag:feature.tag\r\n            })\r\n        })\r\n        theUser.products.push(oneProduct);\r\n        console.log(\"the user is \", theUser.products)\r\n      })\r\n\r\n      return db.collection('users').doc(cred.user.uid).set(theUser) \r\n      })\r\n    }) \r\n    .catch(err=>{\r\n      setError(\"Failed to create an account\");\r\n    })\r\n\r\n    setLoading(false);\r\n  }\r\n\r\n\r\nconst deleteDoc = (n)=>{\r\n    if(n == 0) return;\r\n\r\n    console.log(n);\r\n}\r\n\r\nconst returnFilteredUsers = (users,userId)=>{\r\n    let newUsers = users.filter(user=>{\r\n        return user.id !== userId;\r\n    })\r\n    return newUsers; \r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}