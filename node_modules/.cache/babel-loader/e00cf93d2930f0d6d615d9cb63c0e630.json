{"ast":null,"code":"import { functions, db } from \"../firebase\";\nimport { useAuth } from \"../components/contexts/AuthContext\";\nconst deleteUser = functions.httpsCallable(\"deleteUser\");\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\nconst updateUser = functions.httpsCallable(\"updateUser\");\nexport const handleUpdateUser = (user, setUsers, theOffset, thePageLimit, setCurrentUsers) => {\n  let theUsers = []; // console.log(\"user is \", user)\n\n  return updateUser(user).then(theRecordedUser => {\n    // console.log(\"theRecordedUser\",theRecordedUser)\n    db.collection(\"users\").doc(user.uid).update({\n      email: user.email,\n      password: user.password,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      // userCode:user.userCode,\n      products: user.products\n    }).then(() => {\n      db.collection(\"users\").get().then(snapshot => {\n        snapshot.docs.forEach(user => {\n          user.checked = false; // user.purchased = false;\n\n          theUsers.push(user);\n        });\n        setUsers([...theUsers]);\n\n        if (theOffset || thePageLimit) {\n          setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit));\n        } else {\n          setCurrentUsers([...theUsers]);\n        }\n      });\n    });\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUser = (uid, users, i, setUsers, callback, theOffset, thePageLimit, setCurrentUsers) => {\n  // console.log(\"useActionI\", i,uid)\n  users.splice(i, 1);\n  setUsers([...users]);\n  return deleteUser({\n    uid: uid\n  }).then(() => {\n    db.collection(\"users\").doc(uid).delete();\n    callback();\n\n    if (theOffset || thePageLimit) {\n      setCurrentUsers(users.slice(theOffset, theOffset + thePageLimit));\n    } else {\n      setCurrentUsers([...users]);\n    }\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUsers = (ids, setUsers, callback, theOffset, thePageLimit, setCurrentUsers) => {\n  let theUsers = [];\n  return deleteUsers(ids).then(res => {\n    // console.log(\"res after deleting users\",res);\n    ids.forEach(uid => {\n      db.collection(\"users\").doc(uid).delete();\n    });\n  }).then(() => {\n    db.collection(\"users\").get().then(snapshot => {\n      snapshot.docs.forEach(user => {\n        user.checked = false; // user.purchased = false;\n\n        theUsers.push(user);\n      });\n      setUsers([...theUsers]);\n\n      if (theOffset || thePageLimit) {\n        setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit));\n      } else {\n        setCurrentUsers([...theUsers]);\n      }\n    });\n    callback();\n  }).catch(err => {\n    console.log(\"ERR\", err);\n  });\n};","map":{"version":3,"sources":["E:/Folder/React/projects/my_freelance_work/M.Radwan Work/light-bootstrap-dashboard-react/src/views/UsersAction.js"],"names":["functions","db","useAuth","deleteUser","httpsCallable","deleteUsers","updateUser","handleUpdateUser","user","setUsers","theOffset","thePageLimit","setCurrentUsers","theUsers","then","theRecordedUser","collection","doc","uid","update","email","password","firstName","lastName","products","get","snapshot","docs","forEach","checked","push","slice","catch","err","console","log","handleDeleteUser","users","i","callback","splice","delete","handleDeleteUsers","ids","res"],"mappings":"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","sourcesContent":["import { functions, db } from \"../firebase\";\r\nimport { useAuth } from \"../components/contexts/AuthContext\"\r\nconst deleteUser  = functions.httpsCallable(\"deleteUser\");\r\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\r\nconst updateUser  = functions.httpsCallable(\"updateUser\");\r\n\r\nexport const handleUpdateUser = (user,setUsers,theOffset,thePageLimit,setCurrentUsers)=>{\r\n    let theUsers = [];\r\n    // console.log(\"user is \", user)\r\n    return updateUser(user)\r\n    .then((theRecordedUser)=>{\r\n        // console.log(\"theRecordedUser\",theRecordedUser)\r\n        db.collection(\"users\").doc(user.uid).update({\r\n            email:user.email,\r\n            password:user.password,\r\n            firstName:user.firstName,\r\n            lastName:user.lastName,\r\n            // userCode:user.userCode,\r\n            products:user.products\r\n        }).then(()=>{\r\n            db.collection(\"users\").get().then(snapshot=>{\r\n                snapshot.docs.forEach(user=>{\r\n                    user.checked = false;\r\n                    // user.purchased = false;\r\n                    theUsers.push(user);\r\n                })\r\n                setUsers([...theUsers]);\r\n                if(theOffset || thePageLimit){\r\n                    setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit))\r\n                  }else{\r\n                    setCurrentUsers([...theUsers])\r\n                  }\r\n            })\r\n        })\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUser = (uid,users,i,setUsers,callback,theOffset,thePageLimit,setCurrentUsers)=>{\r\n    // console.log(\"useActionI\", i,uid)\r\n    users.splice(i, 1);\r\n    setUsers([...users]);\r\n\r\n    return deleteUser({uid:uid})\r\n    .then(()=>{\r\n        db.collection(\"users\").doc(uid).delete();\r\n        callback() \r\n        if(theOffset || thePageLimit){\r\n            setCurrentUsers(users.slice(theOffset, theOffset + thePageLimit))\r\n        }else{\r\n            setCurrentUsers([...users])\r\n        }\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUsers = (ids,setUsers, callback,theOffset,thePageLimit,setCurrentUsers) =>{\r\n    let theUsers = [];\r\n    return deleteUsers(ids)\r\n    .then(res=>{\r\n        // console.log(\"res after deleting users\",res);\r\n        ids.forEach(uid => {\r\n            db.collection(\"users\").doc(uid).delete();\r\n        });\r\n    }).then(() => {\r\n        db.collection(\"users\").get().then(snapshot=>{\r\n            snapshot.docs.forEach(user=>{\r\n                user.checked = false;\r\n                // user.purchased = false;\r\n                theUsers.push(user);\r\n            })\r\n            setUsers([...theUsers]);\r\n            if(theOffset || thePageLimit){\r\n                setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit))\r\n              }else{\r\n                setCurrentUsers([...theUsers])\r\n              }\r\n        })\r\n        callback()\r\n    }).catch(err=>{\r\n        console.log(\"ERR\",err);\r\n    })\r\n}\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}