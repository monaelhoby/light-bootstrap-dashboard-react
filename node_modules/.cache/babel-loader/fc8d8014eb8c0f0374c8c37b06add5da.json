{"ast":null,"code":"import { functions, db } from \"../firebase\";\nimport { useAuth } from \"../components/contexts/AuthContext\";\nconst deleteUser = functions.httpsCallable(\"deleteUser\");\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\nconst updateUser = functions.httpsCallable(\"updateUser\");\nexport const handleUpdateUser = (user, setUsers, theOffset, thePageLimit, setCurrentUsers) => {\n  let theUsers = []; // console.log(\"user is \", user)\n\n  return updateUser(user).then(theRecordedUser => {\n    // console.log(\"theRecordedUser\",theRecordedUser)\n    db.collection(\"users\").doc(user.uid).update({\n      email: user.email,\n      password: user.password,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      userCode: user.userCode,\n      products: user.products\n    }).then(() => {\n      db.collection(\"users\").get().then(snapshot => {\n        snapshot.docs.forEach(user => {\n          user.checked = false; // user.purchased = false;\n\n          theUsers.push(user);\n        });\n        setUsers([...theUsers]);\n\n        if (theOffset || thePageLimit) {\n          setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit));\n        } else {\n          setCurrentUsers([...theUsers]);\n        }\n      });\n    });\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUser = (uid, users, i, setUsers, callback, theOffset, thePageLimit, setCurrentUsers) => {\n  // console.log(\"useActionI\", i,uid)\n  users.splice(i, 1);\n  return deleteUser(uid).then(() => {\n    db.collection(\"users\").doc(uid).delete().then(() => {\n      db.collection(\"users\").get().then(snapshot => {\n        // console.log(snapshot)\n        setUsers([snapshot.docs]);\n\n        if (theOffset || thePageLimit) {\n          setCurrentUsers(snapshot.docs.slice(theOffset, theOffset + thePageLimit));\n        } else {\n          setCurrentUsers([snapshot.docs]);\n        }\n      });\n    });\n    callback();\n  }).catch(err => {\n    console.log(\"Err is \", err);\n  });\n};\nexport const handleDeleteUsers = (ids, setUsers, callback, theOffset, thePageLimit, setCurrentUsers) => {\n  let theUsers = [];\n  return deleteUsers(ids).then(res => {\n    // console.log(\"res after deleting users\",res);\n    ids.forEach(uid => {\n      db.collection(\"users\").doc(uid).delete();\n    });\n  }).then(() => {\n    db.collection(\"users\").get().then(snapshot => {\n      snapshot.docs.forEach(user => {\n        user.checked = false; // user.purchased = false;\n\n        theUsers.push(user);\n      });\n      setUsers([...theUsers]);\n\n      if (theOffset || thePageLimit) {\n        setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit));\n      } else {\n        setCurrentUsers([...theUsers]);\n      }\n    });\n    callback();\n  }).catch(err => {\n    console.log(\"ERR\", err);\n  });\n};","map":{"version":3,"sources":["E:/Folder/React/projects/my_freelance_work/M.Radwan Work/light-bootstrap-dashboard-react/src/views/UsersAction.js"],"names":["functions","db","useAuth","deleteUser","httpsCallable","deleteUsers","updateUser","handleUpdateUser","user","setUsers","theOffset","thePageLimit","setCurrentUsers","theUsers","then","theRecordedUser","collection","doc","uid","update","email","password","firstName","lastName","userCode","products","get","snapshot","docs","forEach","checked","push","slice","catch","err","console","log","handleDeleteUser","users","i","callback","splice","delete","handleDeleteUsers","ids","res"],"mappings":"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","sourcesContent":["import { functions, db } from \"../firebase\";\r\nimport { useAuth } from \"../components/contexts/AuthContext\"\r\nconst deleteUser  = functions.httpsCallable(\"deleteUser\");\r\nconst deleteUsers = functions.httpsCallable(\"deleteUsers\");\r\nconst updateUser  = functions.httpsCallable(\"updateUser\");\r\n\r\nexport const handleUpdateUser = (user,setUsers,theOffset,thePageLimit,setCurrentUsers)=>{\r\n    let theUsers = [];\r\n    // console.log(\"user is \", user)\r\n    return updateUser(user)\r\n    .then((theRecordedUser)=>{\r\n        // console.log(\"theRecordedUser\",theRecordedUser)\r\n        db.collection(\"users\").doc(user.uid).update({\r\n            email:user.email,\r\n            password:user.password,\r\n            firstName:user.firstName,\r\n            lastName:user.lastName,\r\n            userCode:user.userCode,\r\n            products:user.products\r\n        }).then(()=>{\r\n            db.collection(\"users\").get().then(snapshot=>{\r\n                snapshot.docs.forEach(user=>{\r\n                    user.checked = false;\r\n                    // user.purchased = false;\r\n                    theUsers.push(user);\r\n                })\r\n                setUsers([...theUsers]);\r\n                if(theOffset || thePageLimit){\r\n                    setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit))\r\n                  }else{\r\n                    setCurrentUsers([...theUsers])\r\n                  }\r\n            })\r\n        })\r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUser = (uid,users,i,setUsers,callback,theOffset,thePageLimit,setCurrentUsers)=>{\r\n    // console.log(\"useActionI\", i,uid)\r\n    users.splice(i, 1);\r\n\r\n    return deleteUser(uid)\r\n    .then( () =>{\r\n        db.collection(\"users\").doc(uid).delete()\r\n        .then(() => {\r\n            db.collection(\"users\").get()\r\n            .then(snapshot => {\r\n                // console.log(snapshot)\r\n                setUsers([snapshot.docs]);\r\n                if(theOffset || thePageLimit){\r\n                    setCurrentUsers(snapshot.docs.slice(theOffset, theOffset + thePageLimit))\r\n                }else{\r\n                    setCurrentUsers([snapshot.docs])\r\n                }\r\n            })\r\n        })\r\n        callback() \r\n    })\r\n    .catch(err=>{\r\n        console.log(\"Err is \", err)\r\n    })\r\n}\r\n\r\nexport const handleDeleteUsers = (ids,setUsers, callback,theOffset,thePageLimit,setCurrentUsers) =>{\r\n    let theUsers = [];\r\n    return deleteUsers(ids)\r\n    .then(res=>{\r\n        // console.log(\"res after deleting users\",res);\r\n        ids.forEach(uid => {\r\n            db.collection(\"users\").doc(uid).delete();\r\n        });\r\n    }).then(() => {\r\n        db.collection(\"users\").get().then(snapshot=>{\r\n            snapshot.docs.forEach(user=>{\r\n                user.checked = false;\r\n                // user.purchased = false;\r\n                theUsers.push(user);\r\n            })\r\n            setUsers([...theUsers]);\r\n            if(theOffset || thePageLimit){\r\n                setCurrentUsers(theUsers.slice(theOffset, theOffset + thePageLimit))\r\n              }else{\r\n                setCurrentUsers([...theUsers])\r\n              }\r\n        })\r\n        callback()\r\n    }).catch(err=>{\r\n        console.log(\"ERR\",err);\r\n    })\r\n}\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}